rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Function to check if user is an admin (Google login)
    function isAdmin() {
      // List of admin emails. Replace with your admin emails.
      return request.auth.token.email == "contactkrishnaworks@gmail.com";
    }

    // Customers collection: Only the customer with matching phoneNumber can read/write their own document
    match /customers/{phoneNumber} {
         // Customer can only read their own document
      allow read: if request.auth != null
        && request.auth.token.phoneNumber == phoneNumber;
        // This ensures the logged-in user's phoneNumber matches the document ID
    }

    match /customers/{customerId} {
      // Only admin can read and write customer documents
      allow read, write: if isAdmin();
      // No access for non-admins (including customers)
    }

    // Schemes collection: anyone (including non-authenticated users) can read
    match /schemes/{schemeId} {
      allow read: if true;          // Public read access
      allow write: if isAdmin();    // Only admin can write
    }

    // Add other collections as needed
  }
}
